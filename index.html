<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
     <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.0/firebase-database.js"></script>
</head>
<body>
    <h1>Set Data</h1>
    <input id="name" placeholder="Name">
    <br>
    <input id="status" placeholder="Status">
    <br>
    <button onclick="post()">Set Data</button>

    <hr>

    <div style="padding: 10px;"></div>

    <input id="getname" placeholder="Search with Name">
    <br>
    <button onclick="getdata()">Get Data</button>

    <h1 id="statusplaceholder"><h1>
    
<script>

    var provider = new firebase.auth.GoogleAuthProvider();
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    var firebaseConfig = {
        apiKey: "AIzaSyA-RKdzhAMJxpwWdP1NHDwCez94Qgth7ac",
        authDomain: "picturebook-eff08.firebaseapp.com",
        databaseURL: "https://picturebook-eff08-default-rtdb.firebaseio.com",
        projectId: "picturebook-eff08",
        storageBucket: "picturebook-eff08.appspot.com",
        messagingSenderId: "95929020875",
        appId: "1:95929020875:web:6fd11cd0c29005a915864e",
        measurementId: "G-4B2DK27XCV"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    var database = firebase.database()

    function post() {
        var database = firebase.database()
        var ref = database.ref('images');

        inname = document.getElementById("name").value
        instatus = document.getElementById("status").value

        var data =
        {
            name: inname,
            status: instatus,
        }

        ref.push(data);
    }

    function getdata() {
            var database = firebase.database();
            var ref = database.ref('images');
            ref.on('value', getdata2, errData) 
        }

    function getdata2(data) {
        var database = firebase.database();
        var ref = database.ref('images');

        var images_data = data.val();
        var keys = Object.keys(images_data);
        console.log(images_data);
        console.log(keys);

        inputname = document.getElementById("getname").value

        for(i=0; i<keys.length; i++) {
            var k = keys[i]
            if(images_data[k].name == inputname) {
                document.getElementById("statusplaceholder").innerHTML = images_data[k].status
                var img = new Image();
                img.src = images_data[k].status
                document.body.appendChild(img);
            }
        }
    }

    function errData(err) {
        console.log('Error!')
        console.log(err)
    }


</script>
</body>

</html>